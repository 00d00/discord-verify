function file()

--[[マタタビ関数]]
function mttb(value)

if not mttbRange then
  range = gg.choice({"Ca: C++ alloc", "A: Anonymous", "O: Other"}, 0, "マタタビの範囲を選択")
  if not range then
      return
  end

  if range == 1 then
      gg.setRanges(4)
  end

  if range == 2 then
      gg.setRanges(32)
  end

  if range == 3 then
      gg.setRanges(-2080896)
  end

  if not value or value == "" then
      return
  end
else
  gg.setRanges(mttbRange)
end

gg.clearResults()
gg.searchNumber("28", 4)
result = {}
result = gg.getResults(gg.getResultsCount())

for a = 1, #result do
    result[a].address = result[a].address - 0xD8
end

gg.loadResults(result)

forSearch = {1, 5}
forOffset = {0x20, 0x4}

for a = 1, 2 do
    gg.refineNumber(forSearch[a], 4)
    result = {}
    result = gg.getResults(gg.getResultsCount())
    for b = 1, #result do
        result[b].address = result[b].address + forOffset[a]
    end
    gg.loadResults(result)
end

gg.removeResults(gg.getResults(gg.getResultsCount() - 1))

if gg.getResultsCount() ~= 0 then
    X = gg.getResults(1)
    V = {{}, {}}
    V[1].address = X[1].address - 0x28
    V[1].flags = 4
    V[1].value = value
    for a = 1, 28 do
        V[2].address = V[1].address + 8 * a
        V[2].flags = 4
        V[2].value = value
        gg.setValues(V)
    end
    gg.toast("成功")
    mttbRange = gg.getRanges()
else
    gg.toast("失敗")
end

gg.setRanges(16)



end

--[[キャラレベル変更関数]]
function charaLevel(value)
  gg.clearResults()
  gg.searchNumber(base .. ";".. os.date("%Y") .. ";" .. os.date("%m"), 4)
  gg.refineNumber(base, 4)
  if gg.getResultsCount() ~= 0 then
    local V = gg.getResults(1)
    V[1].address = V[1].address + 0x25B4
    V = gg.getValues(V)
    gg.clearResults()
    gg.searchNumber(V[1].value - 2 .. "~" .. V[1].value + 2, 4)
    if gg.getResultsCount() == 0 then
      gg.searchNumber(V[1].value + 2 .. "~" .. V[1].value - 2, 4)
    end
    local res = gg.getResults(gg.getResultsCount())
    local address = res[#res].address
    local set = {}
    gg.toast("Loading...")
    for i = 1, #res*2-2 do
      set[i] = {}
      set[i].address = res[#res].address + (i * 4)
      set[i].flags = 4
      set[i].value = value
    end
    gg.setValues(set)
    gg.toast("成功")
  else
    gg.toast("失敗")
  end
end

--[[ステータス改竄関数]]
function charaStatus(name)
  
  gg.clearResults()
  gg.searchNumber("h 88 13 00 00 96 00 00 00 00 00 00 00 00 05", 1, false, 536870912, 0, -1, 1)
  gg.refineNumber("h88", 1)
  local e = gg.getResults(1)
  e[1].flags = 4
  e = gg.getValues(e)
  gg.loadResults(e)
  e = gg.getResults(1)
  local baseA = e[1]
  
  local DataBase = gg.makeRequest("https://battlecats-db.com/unit/r_all.html").content
  if not DataBase then
    gg.toast("データベースの取得に失敗")
    return
  else
    local file = io.open("DataBase.txt", "w")
    file:write(DataBase)
    file:close()
  end
  
  local find = DataBase:find(name)
  if find then
    result = DataBase:sub(find-10, find-8)
    numResult = tonumber(result,10)
    if not numResult then
      gg.alert("キャラ名を取得できませんでした。")
      return
    end
  else
    gg.alert("キャラ名を取得できませんでした。")
    return
  end
  
  local numXx = 1744
  
  local tmp = numResult - 1
  local offset = numXx * tmp
  
  local offsetAddress = baseA.address + offset
  
  gg.alert("\"" .. name .. "\"のステータス改竄を開始します")
  
  AaXx = gg.prompt({
    "体力(お宝無し、Lv1状態でのステータス)",
    "メタル",
    "攻撃力(お宝無し、Lv1状態でのステータス)",
    "再生産時間(フレーム単位)",
    "KB数",
    "移動速度",
    "キャラの値段",
    "波動確率",
    "波動Lv",
  },nil,{
    "number",
    "checkbox",
    "number",
    "number",
    "number",
    "number",
    "number",
    "number",
    "number",
  })
  
  if AaXx ~= nil then
  
if AaXx[1] ~= "" then
  local v = {}
  v[1] = {}
  v[1].address = offsetAddress - 0x18
  v[1].flags = 4
  v[1].value = AaXx[1]
  gg.setValues(v)
  gg.toast("変更を反映しました")
end

if AaXx[2] then
  local v = {}
  v[1] = {}
  v[1].address = offsetAddress + 0x94
  v[1].flags = 4
  v[1].value = 1
  gg.setValues(v)
  gg.toast("変更を反映しました")
else
  local v = {}
  v[1] = {}
  v[1].address = offsetAddress + 0x94
  v[1].flags = 4
  v[1].value = 0
  gg.setValues(v)
  gg.toast("変更を反映しました")
end

if AaXx[3] ~= "" then
  local v = {}
  v[1] = {}
  v[1].address = offsetAddress - 0xC
  v[1].flags = 4
  v[1].value = AaXx[3]
  gg.setValues(v)
  gg.toast("変更を反映しました")
end

if AaXx[4] ~= "" then
  local v = {}
  v[1] = {}
  v[1].address = offsetAddress + 0x4
  v[1].flags = 4
  v[1].value = AaXx[4]
  gg.setValues(v)
  gg.toast("変更を反映しました")
end

if AaXx[5] ~= "" then
  local v = {}
  v[1] = {}
  v[1].address = offsetAddress - 0x14
  v[1].flags = 4
  v[1].value = AaXx[5]
  gg.setValues(v)
  gg.toast("変更を反映しました")
end

if AaXx[6] ~= "" then
  AaXx[6] = AaXx[6]:gsub("[^%d]", "")
  AaXx[6] = tonumber(AaXx[6])
  local v = {}
  v[1] = {}
  v[1].address = offsetAddress - 0x10
  v[1].flags = 4
  v[1].value = AaXx[6] * 2
  gg.setValues(v)
  gg.toast("変更を反映しました")
end

if AaXx[7] ~= "" then
  local v = {}
  v[1] = {}
  v[1].address = offsetAddress
  v[1].flags = 4
  v[1].value = AaXx[7] * 100
  gg.setValues(v)
  gg.toast("変更を反映しました")
end

if AaXx[8] ~= "" then
  local v = {}
  v[1] = {}
  v[1].address = offsetAddress + 0x74
  v[1].flags = 4
  v[1].value = AaXx[8]
  gg.setValues(v)
  gg.toast("変更を反映しました")
end

if AaXx[9] ~= "" then
  local v = {}
  v[1] = {}
  v[1].address = offsetAddress + 0x78
  v[1].flags = 4
  v[1].value = AaXx[9]
  gg.setValues(v)
  gg.toast("変更を反映しました")
end
end
end

































--[[初期設定]]
gg.setRanges(16)
gg.skipRestoreState()
gg.toast("★Battle Cats Script★\n作者:i5_xyz")
count1 = 0
count2 = 0
speed = gg.getSpeed()
gg.setVisible(false)

--[[bit特定]]
local getBit = gg.getTargetInfo()
if not (getBit and getBit.x64) then
  gg.alert("64bit専用スクリプトです。\nスクリプトを終了します。")
  gg.setVisible(true)
  os.exit()
end

--[[プロセス特定]]
local targetPackage = gg.getTargetPackage()
if targetPackage ~= "jp.co.ponos.battlecats" then
  gg.alert("プロセスが設定されていません。\nスクリプトを終了します。")
  gg.setVisible(true)
  os.exit()
end

--[[ベース値特定]]
gg.clearResults()
gg.searchNumber("32400;" .. os.date("%Y") .. ";" .. os.date("%m") .. "::29", 4)
gg.refineNumber("32400", 4)
if gg.getResultsCount() == 0 then
  gg.clearResults()
  gg.searchNumber("28800;" .. os.date("%Y") .. ";" .. os.date("%m") .. "::29", 4)
  gg.refineNumber("28800", 4)
  if gg.getResultsCount() == 0 then
    local choice = gg.alert("現在ベースを取得できないので制限付きモードです。実行しますか？", "はい", "いいえ")
    if choice ~= 1 then
      gg.setVisible(true)
      os.exit()
    end
  else
    base = "28800"
  end
else
  base = "32400"
end

--[[ホームメニュー表示]]
function Home()
  local X = gg.choice({
    "メインメニュー",
    "サブメニュー1",
    "サブメニュー2",
    "バトルメニュー",
    "EXIT"
  }, 0, "BATTLE CATS SCRIPT")

  if X == nil then return end

  if X == 1 then Main() end
  if X == 2 then Sub1() end
  if X == 3 then Sub2() end
  if X == 4 then Battle() end
  if X == 5 then Exit() end
end

--[[メインメニュー]]
function Main()
  local X = gg.prompt({
    "【ネコ缶を改竄】",
    "ネコ缶 [1;58999]",
    "【XPを改竄】",
    "XP [1;99999999]",
    "【NPを改竄】",
    "NP [1;99999]",
    "【にゃんチケを改竄】",
    "にゃんチケ [1;999]",
    "【レアチケを改竄】",
    "レアチケ [1;999]",
    "【プラチケを改竄】",
    "プラチケ [1;5]",
    "【かけらを改竄】",
    "かけら [1;100]",
    "【レジェチケを改竄】",
    "レジェチケ [1;5]",
    "戻る"
  }, {
    false,
    "58000",
    false,
    "99999999",
    false,
    "50000",
    false,
    "200",
    false,
    "200",
    false,
    "3",
    false,
    "10",
    false,
    "3",
    false
  }, {
    "checkbox",
    "number",
    "checkbox",
    "number",
    "checkbox",
    "number",
    "checkbox",
    "number",
    "checkbox",
    "number",
    "checkbox",
    "number",
    "checkbox",
    "number",
    "checkbox",
    "number",
    "checkbox"
  })

  if not X then return end

  if X[1] then
    gg.clearResults()
    gg.searchNumber("0;0~~0;" .. base .. ":225", 4)
    if gg.getResultsCount ~= 0 then
      gg.getResults(2)
      gg.editAll(X[2] .. ";0", 4)
      gg.toast("成功")
    else
      gg.toast("失敗")
    end
  end

  if X[3] then
    gg.clearResults()
    gg.searchNumber(base .. ";" .. os.date("%Y") .. ";" .. os.date("%m"), 4)
    gg.refineNumber(base, 4)
    if gg.getResultsCount() ~= 0 then
      local V = gg.getResults(1)
      V[2] = {}
      V[1].address = V[1].address + 0x40
      V[2].address = V[1].address + 0x4
      V[1].flags = 4
      V[2].flags = 4
      V[1].value = X[4]
      V[2].value = 0
      gg.setValues(V)
      gg.toast("成功")
    else
      gg.toast("失敗")
    end
  end

  if X[5] then
    gg.clearResults()
    gg.searchNumber(base .. ";" .. os.date("%Y") .. ";" .. os.date("%m"), 4)
    gg.refineNumber(base, 4)
    if gg.getResultsCount() ~= 0 then
      local V = gg.getResults(1)
      V[2] = {}
      V[1].address = V[1].address + 0x48
      V[2].address = V[1].address + 0x4
      V[1].flags = 4
      V[2].flags = 4
      V[1].value = X[6]
      V[2].value = 0
      gg.setValues(V)
      gg.toast("成功")
    else
      gg.toast("失敗")
    end
  end

  if X[7] then
    gg.clearResults()
    gg.searchNumber(base .. ";" .. base .. ";1;1;0;0~~0::1450", 4)
    if gg.getResultsCount() ~= 0 then
      local res = gg.getResults(gg.getResultsCount())
      local V = {res[#res]}
      V[2] = {}
      V[1].value = X[8]
      V[2].address = V[1].address + 0x4
      V[2].flags = 4
      V[2].value = 0
      gg.setValues(V)
      gg.toast("成功")
    else
      gg.toast("失敗")
    end
  end

  if X[9] then
    gg.clearResults()
    gg.searchNumber(base .. ";" .. base .. ";1;1;0;0~~0::1450", 4)
    if gg.getResultsCount() ~= 0 then
      local res = gg.getResults(gg.getResultsCount())
      local V = {res[#res]}
      V[2] = {}
      V[1].address = V[1].address + 0x8
      V[1].flags = 4
      V[1].value = X[10]
      V[2].address = V[1].address + 0x4
      V[2].flags = 4
      V[2].value = 0
      gg.setValues(V)
      gg.toast("成功")
    else
      gg.toast("失敗")
    end
  end

  if X[11] then
    gg.clearResults()
    gg.searchNumber("105;0;0~~0;1;2::97", 4)
    if gg.getResultsCount() == 10 then
      local rem = gg.getResults(2)
      gg.removeResults(rem)
      gg.getResults(2)
      gg.editAll(X[12] .. ";0", 4)
      gg.toast("成功")
    else
      gg.toast("失敗")
    end
  end

  if X[13] then
    gg.clearResults()
    gg.searchNumber("105;0;0~~0;1;2::97", 4)
    if gg.getResultsCount() == 10 then
      local rem = gg.getResults(6)
      gg.removeResults(rem)
      gg.getResults(2)
      gg.editAll(X[14] .. ";0", 4)
      gg.toast("成功")
    else
      gg.toast("失敗")
    end
  end

  if X[15] then
    gg.clearResults()
    gg.searchNumber("105;0;0~~0;1;2::97", 4)
    if gg.getResultsCount() == 10 then
      local rem = gg.getResults(4)
      gg.removeResults(rem)
      gg.getResults(2)
      gg.editAll(X[16] .. ";0", 4)
      gg.toast("成功")
    else
      gg.toast("失敗")
    end
  end

  if X[17] then
    Home()
  end
end

--[[サブ1メニュー]]
function Sub1()
  local X = gg.multiChoice({
    "全キャラ開放",
    "全キャラレベルマックス",
    "全キャラレベル1",
    "全ステ開放",
    "戻る"
  })

  if not X then return end

  if X[1] then
    gg.clearResults()
    gg.searchNumber(base .. ";".. os.date("%Y") .. ";" .. os.date("%m"), 4)
    gg.refineNumber(base, 4)
    if gg.getResultsCount() ~= 0 then
      local V = gg.getResults(1)
      V[1].address = V[1].address + 0x25B4
      V = gg.getValues(V)
      gg.clearResults()
      gg.searchNumber(V[1].value - 2 .. "~" .. V[1].value + 2, 4)
      if gg.getResultsCount() == 0 then
        gg.searchNumber(V[1].value - 2 .. "~" .. V[1].value + 2, 4)
      end
      V = gg.getResults(1)
      gg.getResults(gg.getResultsCount()-1)
      gg.editAll(V[1].value, 4)
      gg.toast("成功")
    else
      gg.toast("失敗")
    end
  end

  if X[2] then
    gg.alert("広告を削除するには、機内モードにしてください", "はい")
    charaLevel(999)
  end

  if X[3] then
    charaLevel(0)
  end

  if X[4] then
    gg.clearResults()
    gg.searchNumber(base .. ";".. os.date("%Y") .. ";" .. os.date("%m"), 4)
    gg.refineNumber(base, 4)
    if gg.getResultsCount() ~= 0 then
      local V = gg.getResults(1)
      V[1].address = V[1].address + 0x610
      for i = 1, 11 do
        V[1].address = V[1].address + 0x4
        V[1].flags = 4
        V[1].value = 0
        gg.setValues(V)
      end
      V[1].value = 48
      gg.setValues(V)
      gg.toast("成功")
    else
      gg.toast("失敗")
    end
  end

  if X[5] then
    Home()
  end
end

--[[サブ2メニュー]]
function Sub2()
  local X = gg.prompt({
    "【EXキャッツアイを改竄】",
    "EXキャッツアイ [1;999]",
    "【レアキャッツアイを改竄】",
    "レアキャッツアイ [1;999]",
    "【激レアキャッツアイを改竄】",
    "激レアキャッツアイ [1;999]",
    "【超激レアキャッツアイを改竄】",
    "超激レアキャッツアイ [1;999]",
    "【伝説レアキャッツアイを改竄】",
    "伝説レアキャッツアイ [1;999]",
    "【闇キャッツアイを改竄】",
    "闇キャッツアイ [1;999]",
    "戻る"
  }, {
    false,
    "999",
    false,
    "999",
    false,
    "999",
    false,
    "999",
    false,
    "999",
    false,
    "999",
    false
  }, {
    "checkbox",
    "number",
    "checkbox",
    "number",
    "checkbox",
    "number",
    "checkbox",
    "number",
    "checkbox",
    "number",
    "checkbox",
    "number",
    "checkbox"
  })

  if not X then return end

  gg.clearResults()
  gg.searchNumber("1;227;235;0~~0;0::213", 4)
  local r = gg.getResults(3)
  gg.removeResults(r)
  if gg.getResultsCount() > 11 then
    local V = gg.getResults(12)
    for i = 2, 12, 2 do
      if X[i-1] then
        V[i-1].value = tonumber(X[i])
        V[i].value = 0
        gg.toast("成功")
      end
    end
    gg.setValues(V)
  else
    gg.toast("失敗")
  end

  if X[13] then
    Home()
  end
end

--[[戦闘メニュー]]
function Battle()

  local ok = false
  gg.clearResults()
  gg.searchNumber("4400", 4)
  local res = gg.getResults(2)
  res[2].address = res[2].address - 0x4
  res = gg.getValues(res)
  if res[2].value == 3200 then
    ok = true
  end
  res[2].address = res[2].address + 0x14
  local vvalue = gg.getValues(res)[2].value

  local X = gg.prompt({
    "敵城体力を変更する",
    "敵城体力フリーズ",
    "敵城体力",
    "味方城体力を変更する",
    "味方城フリーズ",
    "味方城体力",
    "キャラ値段変更",
    "戻る"
  }, {
    false,
    false,
    vvalue,
    false,
    false,
    "1000000",
    false,
    false
  }, {
    "checkbox",
    "checkbox",
    "number",
    "checkbox",
    "checkbox",
    "number",
    "checkbox",
    "checkbox"
  })

  if not X then return end

  if X[1] and tonumber(X[3]) ~= nil then
    gg.clearResults()
    gg.searchNumber("4400", 4)
    local res = gg.getResults(2)
    res[2].address = res[2].address - 0x4
    res = gg.getValues(res)
    if res[2].value == 3200 then
      local V = {{}}
      V[1].address = res[2].address + 0x14
      V[1].flags = 4
      V[1].value = X[3]
      if X[2] then
        V[1].name = "敵城体力"
        V[1].freeze = true
        gg.addListItems(V)
      else
        V[1].freeze = false
        gg.setValues(V)
      end
      gg.toast("成功")
    else
      gg.toast("失敗")
    end
  end

  if X[4] and tonumber(X[6]) ~= nil then
    gg.clearResults()
    gg.searchNumber("4400", 4)
    local res = gg.getResults(1)
    if ok then
      local V = {{}}
      V[1].address = res[1].address + 0x10
      V[1].flags = 4
      V[1].value = X[6]
      if X[5] then
        V[1].name = "味方城体力"
        V[1].freeze = true
        gg.addListItems(V)
      else
        V[1].freeze = false
        gg.addListItems(V)
      end
      gg.setValues(V)
      gg.toast("成功")
    else
      gg.toast("失敗")
    end
  end

  if X[7] then
    local TYPE = gg.prompt({
      "全キャラ値段0円",
      "全キャラの値段を戻す",
      "戻る"
    }, nil, {
      "checkbox",
      "checkbox",
      "checkbox"
    })

    if TYPE[1] then
      if count1 == 0 then
        count1 = 1
        gg.clearResults()
        gg.searchNumber("0~~0;1,280;9::40", 4)
        gg.refineNumber("5000~800000", 4)
        if gg.getResultsCount() ~= 0 then
          charaPrice = gg.getResults(gg.getResultsCount())
        end
      end
      gg.clearResults()
      gg.searchNumber("0~~0;1,280;9::40", 4)
      gg.refineNumber("5000~800000", 4)
      if gg.getResultsCount() ~= 0 then
        gg.getResults(gg.getResultsCount())
        gg.editAll("0", 4)
        gg.toast("成功")
      else
        gg.toast("失敗")
      end
    end

    if TYPE[2] then
      if count1 == 1 then
        count1 = 0
        if charaPrice then
          gg.setValues(charaPrice)
          gg.toast("成功")
        else
          gg.toast("失敗")
        end
      end
    end

    if TYPE[3] then
      Home()
    end
  end

  if X[8] then
    Home()
  end
end

--[[終了関数]]
function Exit()
  gg.clearResults()
  gg.setVisible(true)
  os.exit()
end













function Limited()
  local X = gg.multiChoice({
    "城破壊",
    "ベースを再取得する",
    "終了"
  }, nil, "制限付きモード")

  if not X then return end

  if X[1] then
    gg.clearResults()
    gg.searchNumber("4400", 4)
    local res = gg.getResults(2)
    local V = {res[2]}
    V[1].address = V[1].address - 0x4
    if gg.getValues(V)[1].value == 3200 then
      V[1].address = V[1].address + 0x14
      V[1].flags = 4
      V[1].value = 0
      gg.setValues(V)
      gg.toast("成功")
    else
      gg.toast("失敗")
    end
  end

  if X[2] then
    file()
  end

  if X[3] then
    Exit()
  end
end

--[[ホーム関数呼び出し]]
gg.setVisible(true)

--[[ループ1(制限付きモード)]]
while not base do
  if gg.isVisible(true) then
    gg.setVisible(false)
    Limited()
  end
  if limit then
    break
  end
end

gg.setVisible(true)

--[[ループ2]]
while true do
  if gg.isVisible(true) then
    gg.setVisible(false)
    Home()
  end
end

end

file()
