<!DOCTYPE html>
<html>
<head>
    <title>ファイルの読み込み</title>
</head>
<body>
    <input type="file" id="fileInput">
    <pre id="encrypted"></pre>

    <script>
        function findMatches(inputText, regexPattern) {
            let match;
            const matches = [];
            while ((match = regexPattern.exec(inputText)) !== null) {
                matches.push(match[0]);
            }
            return matches;
        }

        function encrypt(content) {
            const table = findMatches(content, /gg\..*\(/g);
            for (var i = 0; i < table.length; i++) {
                content = content.replace(table[i], "Ox_" + i.toString(16) + "(");
                content = "Ox_" + i.toString(16) + " = " + table[i].slice(0, -1) + "\n" + content
            }
            content = content.replace(/\n/g, ';');
            content = content.replace(/\s+/g, ' ');

            let preElement = document.getElementById("encrypted");
            preElement.textContent = content;
        }

        document.getElementById('fileInput').addEventListener('change', function (event) {
            const fileInput = event.target;
            const file = fileInput.files[0];

            if (file) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    const fileContent = e.target.result;
                    encrypt(fileContent);
                };
                reader.readAsText(file, 'UTF-8');
            }
        });
    </script>
</body>
</html>
